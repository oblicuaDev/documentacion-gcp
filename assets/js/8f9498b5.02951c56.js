"use strict";(globalThis.webpackChunkbilly_gcp=globalThis.webpackChunkbilly_gcp||[]).push([[4762],{755:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>x,frontMatter:()=>i,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"pubsub-mensajeria","title":"\ud83d\udcec Esquema y Contrato de Datos","description":"Aunque el flujo central de Billy se maneja mediante orquestaci\xf3n HTTP (Cloud Workflows a Cloud Run), la uniformidad de los datos se rige por un Esquema Est\xe1ndar de Mensajer\xeda. Este esquema es el contrato de datos que todos los adaptadores (get-data-from-*) deben generar.","source":"@site/docs/pubsub-mensajeria.md","sourceDirName":".","slug":"/pubsub-mensajeria","permalink":"/documentacion-gcp/docs/pubsub-mensajeria","draft":false,"unlisted":false,"editUrl":"https://github.com/oblicuaDev/documentacion-gcp/tree/main/docs/pubsub-mensajeria.md","tags":[],"version":"current","frontMatter":{"id":"pubsub-mensajeria","title":"\ud83d\udcec Esquema y Contrato de Datos","sidebar_label":"Esquema de Datos"},"sidebar":"billyGcpSidebar","previous":{"title":"Orquestaci\xf3n Central","permalink":"/documentacion-gcp/docs/orquestacion/billy-workflow"},"next":{"title":"Secret Manager","permalink":"/documentacion-gcp/docs/secret-manager"}}');var s=l(4848),d=l(8453);const i={id:"pubsub-mensajeria",title:"\ud83d\udcec Esquema y Contrato de Datos",sidebar_label:"Esquema de Datos"},r="Esquema y Contrato de Datos de Billy",a={},o=[{value:"1. Esquema de la Factura Est\xe1ndar",id:"1-esquema-de-la-factura-est\xe1ndar",level:2},{value:"2. Payload de Ejemplo (JSON)",id:"2-payload-de-ejemplo-json",level:2},{value:"3. Temas de Pub/Sub (Registro)",id:"3-temas-de-pubsub-registro",level:2}];function c(e){const t={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"esquema-y-contrato-de-datos-de-billy",children:"Esquema y Contrato de Datos de Billy"})}),"\n",(0,s.jsxs)(t.p,{children:["Aunque el flujo central de Billy se maneja mediante orquestaci\xf3n HTTP (Cloud Workflows a Cloud Run), la uniformidad de los datos se rige por un ",(0,s.jsx)(t.strong,{children:"Esquema Est\xe1ndar de Mensajer\xeda"}),". Este esquema es el ",(0,s.jsx)(t.strong,{children:"contrato de datos"})," que todos los adaptadores (",(0,s.jsx)(t.code,{children:"get-data-from-*"}),") deben generar."]}),"\n",(0,s.jsx)(t.h2,{id:"1-esquema-de-la-factura-est\xe1ndar",children:"1. Esquema de la Factura Est\xe1ndar"}),"\n",(0,s.jsxs)(t.p,{children:["El ",(0,s.jsx)(t.em,{children:"payload"})," de cada factura procesada y pasada al ",(0,s.jsx)(t.code,{children:"Billy-workflow"})," (en la variable ",(0,s.jsx)(t.code,{children:"invoices"}),") debe coincidir con esta estructura."]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Campo"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Tipo"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Descripci\xf3n"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Ejemplo"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"No._Factura"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Identificador \xfanico de la factura en el sistema de origen."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"FV-3-60"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Monto"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Monto total pendiente de cobro."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"150000.50"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"D\xedas_en_Mora"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"N\xfamero de d\xedas que la factura lleva vencida (puede ser negativo si no ha vencido)."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"18"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Fecha_de_vencimiento"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["Fecha de vencimiento, formato ",(0,s.jsx)(t.code,{children:"YYYY-MM-DD"}),"."]}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"2025-10-30"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Raz\xf3n_social_cliente"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Nombre del cliente o raz\xf3n social."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"Cliente Ejemplo SAS"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"email_Cliente"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Correo electr\xf3nico principal del destinatario."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"contacto@cliente.com"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Cel_Cliente"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"N\xfamero de tel\xe9fono (usado para SMS/WhatsApp)."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"3001234567"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"Indicativo_Cel_Cliente"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"C\xf3digo de pa\xeds para el celular."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:'"57"'})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"__ROW_NUMBER__"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Number (Opcional)"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"N\xfamero de fila original si la fuente es Google Sheets."}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"24"})})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"2-payload-de-ejemplo-json",children:"2. Payload de Ejemplo (JSON)"}),"\n",(0,s.jsxs)(t.p,{children:["Este es el formato JSON que las funciones de transformaci\xf3n (",(0,s.jsx)(t.code,{children:"get-data-from-cuenti"}),", etc.) deben producir:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",metastring:'title="Ejemplo de Factura Estandarizada"',children:'{\n  "No._Factura": "FAC-SIIGO-456",\n  "Monto": 500000,\n  "D\xedas_en_Mora": 45,\n  "Fecha_de_vencimiento": "2025-08-30",\n  "Raz\xf3n_social_cliente": "Compa\xf1\xeda Alpha",\n  "email_Cliente": "cobro@alpha.com",\n  "Cel_Cliente": "3109876543",\n  "Indicativo_Cel_Cliente": "57"\n}\n'})}),"\n",(0,s.jsx)(t.h2,{id:"3-temas-de-pubsub-registro",children:"3. Temas de Pub/Sub (Registro)"}),"\n",(0,s.jsx)(t.p,{children:"Aunque los datos no fluyen por Pub/Sub en el workflow central, si se utilizara un sistema de logging as\xedncrono o de registro de eventos, se utilizar\xedan los siguientes temas:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:'billy-events: Registro de eventos de alto nivel (ej. "Se complet\xf3 la ejecuci\xf3n del workflow", "El adaptador X fall\xf3").'}),"\n",(0,s.jsx)(t.li,{children:'billy-audit-log: Registro detallado de cada acci\xf3n de env\xedo (ej. "SMS enviado a 3001234567").'}),"\n"]})]})}function x(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,t,l)=>{l.d(t,{R:()=>i,x:()=>r});var n=l(6540);const s={},d=n.createContext(s);function i(e){const t=n.useContext(d);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(d.Provider,{value:t},e.children)}}}]);