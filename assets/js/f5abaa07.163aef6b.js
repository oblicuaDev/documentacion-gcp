"use strict";(globalThis.webpackChunkbilly_gcp=globalThis.webpackChunkbilly_gcp||[]).push([[28],{2628:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>x,frontMatter:()=>d,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"secret-manager","title":"\ud83d\udd11 Gesti\xf3n de Secretos (Secret Manager)","description":"Google Cloud Secret Manager es el servicio centralizado para almacenar todas las claves de API, tokens de acceso y credenciales sensibles utilizadas por Billy. Esto garantiza que la informaci\xf3n sensible nunca est\xe9 hardcodeada en el c\xf3digo fuente ni expuesta en variables de entorno.","source":"@site/docs/secret-manager.md","sourceDirName":".","slug":"/secret-manager","permalink":"/documentacion-gcp/docs/secret-manager","draft":false,"unlisted":false,"editUrl":"https://github.com/oblicuaDev/documentacion-gcp/tree/main/docs/secret-manager.md","tags":[],"version":"current","frontMatter":{"id":"secret-manager","title":"\ud83d\udd11 Gesti\xf3n de Secretos (Secret Manager)","sidebar_label":"Secret Manager"},"sidebar":"billyGcpSidebar","previous":{"title":"Esquema de Datos","permalink":"/documentacion-gcp/docs/pubsub-mensajeria"},"next":{"title":"Seguridad (IAM)","permalink":"/documentacion-gcp/docs/seguridad-iam"}}');var n=t(4848),i=t(8453);const d={id:"secret-manager",title:"\ud83d\udd11 Gesti\xf3n de Secretos (Secret Manager)",sidebar_label:"Secret Manager"},r="Gesti\xf3n de Secretos en Billy GCP",c={},a=[{value:"1. Convenci\xf3n de Nomenclatura para Credenciales de Cliente",id:"1-convenci\xf3n-de-nomenclatura-para-credenciales-de-cliente",level:2},{value:"2. Listado de Secretos Centrales y su Uso",id:"2-listado-de-secretos-centrales-y-su-uso",level:2},{value:"3. Flujo de Vida de una Credencial",id:"3-flujo-de-vida-de-una-credencial",level:2}];function o(e){const s={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"gesti\xf3n-de-secretos-en-billy-gcp",children:"Gesti\xf3n de Secretos en Billy GCP"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Google Cloud Secret Manager"})," es el servicio centralizado para almacenar todas las claves de API, ",(0,n.jsx)(s.em,{children:"tokens"})," de acceso y credenciales sensibles utilizadas por Billy. Esto garantiza que la informaci\xf3n sensible nunca est\xe9 ",(0,n.jsx)(s.em,{children:"hardcodeada"})," en el c\xf3digo fuente ni expuesta en variables de entorno."]}),"\n",(0,n.jsx)(s.h2,{id:"1-convenci\xf3n-de-nomenclatura-para-credenciales-de-cliente",children:"1. Convenci\xf3n de Nomenclatura para Credenciales de Cliente"}),"\n",(0,n.jsxs)(s.p,{children:["Las credenciales de los sistemas de facturaci\xf3n de terceros se almacenan bajo una convenci\xf3n estricta que permite al ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"Billy-workflow"})})," construir la ruta de acceso de forma din\xe1mica:"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Formato:"})," ",(0,n.jsx)(s.code,{children:"[servicio-min\xfasculas]-[billy_user]-credentials"})]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"Segmento"}),(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"Descripci\xf3n"}),(0,n.jsxs)(s.th,{style:{textAlign:"left"},children:["Ejemplo de Valor (Ver imagen: ",(0,n.jsx)(s.code,{children:"siigo-302-credentials"}),")"]})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"servicio-min\xfasculas"})}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["Plataforma de facturaci\xf3n (ej. ",(0,n.jsx)(s.code,{children:"siigo"}),", ",(0,n.jsx)(s.code,{children:"cuenti"}),", ",(0,n.jsx)(s.code,{children:"allegra"}),")."]}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"siigo"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"billy_user"})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Identificador \xfanico del cliente de Oblicua."}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:[(0,n.jsx)(s.code,{children:"302"})," o ",(0,n.jsx)(s.code,{children:"21"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:"Secreto Resultante"})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"siigo-302-credentials"})}),(0,n.jsx)(s.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"2-listado-de-secretos-centrales-y-su-uso",children:"2. Listado de Secretos Centrales y su Uso"}),"\n",(0,n.jsxs)(s.p,{children:["Se han a\xf1adido los secretos necesarios para la integraci\xf3n avanzada con ",(0,n.jsx)(s.strong,{children:"WhatsApp (API de Meta)"})," y las plantillas de mensaje asociadas."]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"Nombre del Secreto"}),(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"Uso Principal"}),(0,n.jsx)(s.th,{style:{textAlign:"left"},children:"Funci\xf3n que lo Utiliza"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"openai-api-key"})})}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["Clave de acceso a la API de ",(0,n.jsx)(s.strong,{children:"OpenAI"})," (Generaci\xf3n de tono y contenido)."]}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"billy-api-token"})})}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["Token para autenticarse en la ",(0,n.jsx)(s.strong,{children:"API de Registro de Billy"})," (",(0,n.jsx)(s.em,{children:"analytics"}),")."]}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"google-sheets-credentials"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Cuenta de Servicio con permisos de solo lectura para Google Sheets."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"get-data-from-sheets"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"campaign-monitor-api-key"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Clave para enviar correos electr\xf3nicos transaccionales."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"smsto-api-key"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Clave para el env\xedo de mensajes SMS."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-api-token"})})}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["Token de acceso a la API principal de ",(0,n.jsx)(s.strong,{children:"Meta/WhatsApp"}),"."]}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-billy-sos-api-token"})})}),(0,n.jsxs)(s.td,{style:{textAlign:"left"},children:["Token especial para el flujo de ",(0,n.jsx)(s.strong,{children:"SOS Jur\xeddico"})," (Usuario 20)."]}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-template-exigente"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Contenido de la plantilla para el tono exigente."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-template-formal"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Contenido de la plantilla para el tono formal."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-template-amistoso"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Contenido de la plantilla para el tono amistoso/amigable."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"whatsapp-template-sos-juridico"})})}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:"Contenido de la plantilla para el caso especial de SOS Jur\xeddico."}),(0,n.jsx)(s.td,{style:{textAlign:"left"},children:(0,n.jsx)(s.code,{children:"process-and-send-message"})})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"3-flujo-de-vida-de-una-credencial",children:"3. Flujo de Vida de una Credencial"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Creaci\xf3n:"})," El ",(0,n.jsx)(s.em,{children:"frontend"})," del usuario env\xeda las credenciales de un tercero a la funci\xf3n ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"save-user-credentials"})}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Almacenamiento:"})," ",(0,n.jsx)(s.code,{children:"save-user-credentials"})," crea o actualiza el secreto en Secret Manager bajo la convenci\xf3n ",(0,n.jsx)(s.code,{children:"[servicio]-[usuario]-credentials"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Acceso:"})," El ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"Billy-workflow"})})," recupera el secreto llamando a la API de Secret Manager, utilizando la Cuenta de Servicio del Workflow (que debe tener el rol ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"Secret Manager Secret Accessor"})}),")."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Uso:"})," El Workflow pasa el valor del secreto (el ",(0,n.jsx)(s.em,{children:"payload"})," de la credencial) a la funci\xf3n de adaptaci\xf3n correspondiente (",(0,n.jsx)(s.code,{children:"get-data-from-siigo"}),", etc.) a trav\xe9s del cuerpo de la petici\xf3n HTTP."]}),"\n"]})]})}function x(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>d,x:()=>r});var l=t(6540);const n={},i=l.createContext(n);function d(e){const s=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),l.createElement(i.Provider,{value:s},e.children)}}}]);